<b-details    
  [loading]="loading$ | async"
  [error]="error$ | async"
  [viewModel]="tenant"
  [createNewPre]="createNewPre"
  [createNewModel]="createNewModel"
  [canUpdatePred]="canCreatePred"             
  (fetchEvent)="search($event)"
  (saveEvent)="save($event)"
  (updateEvent)="update($event)"
  (deleteEvent)="delete($event)"
  masterCrumb="Tenants"           
  [detailsCrumb]="detailsCrumb"                   
  [viewEditTemplate]="editView"
  [sidebarTemplate]="sidebar">
</b-details>

<!-- Details Crumb -->
<ng-template #detailsCrumb let-model="model">
  <span>{{ model?.TenantCode }}</span>
</ng-template>


<!-- Edit/View Template -->
<ng-template #editView let-model="model" let-isEdit="isEdit">
  <!-- Serial (Header) -->
  <div class="w-100 mb-2 mb-sm-4">
    <h2 class="col-12 font-weight-normal">{{ model?.Id }}</h2>
  </div>

  <div class="mt-2 mt-lg-1 col-12">
    <mat-form-field class="mx-2">
        <input matInput placeholder="Tenant Code"  [(ngModel)]="model.TenantCode" name="TenantCode" [disabled]="!isEdit">
    </mat-form-field>
    <mat-form-field class="mx-2">
        <input matInput placeholder="Tenant Name"  [(ngModel)]="model.TenantName" name="TenantName" [disabled]="!isEdit">
    </mat-form-field>
    <!-- Date -->
    <mat-form-field class="mx-2">
      <input matInput [matDatepicker]="RegistrationDatePicker" placeholder="Registration Date" [(ngModel)]="model.RegistrationDate" name="RegistrationDate" [disabled]="!isEdit">
      <mat-datepicker-toggle matSuffix [for]="RegistrationDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #RegistrationDatePicker></mat-datepicker>
    </mat-form-field>      
    <mat-form-field class="mx-2">
        <input matInput placeholder="Currency Code"  [(ngModel)]="model.CurrencyCode" name="CurrencyCode" [disabled]="!isEdit">
    </mat-form-field>    
    <mat-form-field class="mx-2">
        <input matInput placeholder="RegistrationNumber"  [(ngModel)]="model.RegistrationNumber" name="RegistrationNumber" [disabled]="!isEdit">
    </mat-form-field>  
    <mat-form-field class="mx-2">
        <input matInput placeholder="Phone"  [(ngModel)]="model.Phone" name="Phone" type="tel" [disabled]="!isEdit">
    </mat-form-field>
    <mat-form-field class="mx-2">
        <input matInput placeholder="Email"  [(ngModel)]="model.Email" name="Email" type="email" [disabled]="!isEdit">
    </mat-form-field>
    <mat-form-field class="mx-2">
        <input matInput placeholder="Url"  [(ngModel)]="model.Url" name="Url" type="url" [disabled]="!isEdit">
    </mat-form-field> 

    <!--Address-->
    <div class="mt-2 my-lg-1 col-12">
      <div class="font-weight-bold my-2 col-12">
        <span class="b-vertical-align-middle">Address</span>
      </div>
      <mat-form-field class="mx-2">
          <input matInput placeholder="Country"  [(ngModel)]="model.Country" name="Country" [disabled]="!isEdit">
      </mat-form-field>
      <mat-form-field class="mx-2">
          <input matInput placeholder="Zip Code"  [(ngModel)]="model.ZipCode" name="ZipCode" type="number" [disabled]="!isEdit">
      </mat-form-field>
      <mat-form-field class="mx-2">
          <input matInput placeholder="State"  [(ngModel)]="model.State" name="State" [disabled]="!isEdit">
      </mat-form-field>
      <mat-form-field class="mx-2">
          <input matInput placeholder="City"  [(ngModel)]="model.City" name="City" [disabled]="!isEdit">
      </mat-form-field>
      <mat-form-field class="mx-2">
          <input matInput placeholder="Address Line1"  [(ngModel)]="model.AddressLine1" name="AddressLine1" [disabled]="!isEdit">
      </mat-form-field>
      <mat-form-field class="mx-2">
          <input matInput placeholder="Address Line2"  [(ngModel)]="model.AddressLine2" name="AddressLine2" [disabled]="!isEdit">
      </mat-form-field>
      <mat-form-field class="mx-2">
          <input matInput placeholder="Street"  [(ngModel)]="model.Street" name="Street" [disabled]="!isEdit">
      </mat-form-field>       
    </div>

  </div>

  <!--Auditable-->
  <div class="font-weight-bold small col-12 col-lg-4">
    <span class="b-vertical-align-middle">Created On</span>
  </div>
  <div class="w-100 mb-2 mb-sm-4">
    <h2 class="col-12 font-weight-normal">{{ model?.CreatedOn| date }}</h2>
  </div>

  <div class="font-weight-bold small col-12 col-lg-4">
    <span class="b-vertical-align-middle">Updated On</span>
  </div>
  <div class="w-100 mb-2 mb-sm-4">
    <h2 class="col-12 font-weight-normal">{{ model?.UpdatedOn| date }}</h2>
  </div>

  <!--Table-->
  <div class="table-responsive pt-4 pt-sm-5 " *ngIf="isVisibleTable(model)">
    <table class="table table table-striped w-auto mb-2 mb-sm-0" >
      <thead class="small thead-light2">
        <tr>
          <th class="text-left">OfficeCode</th>
          <th class="text-left">OfficeName</th>
          <th class="text-left">RegistrationDate</th>
          <th class="text-left">CurrencyCode</th>
          <th class="text-left">RegistrationNumber</th>
          <th class="text-left">Phone</th>
          <th class="text-left">Email</th>
          <th class="text-left">Url</th>
          <th class="text-left">Country</th>
          <th class="text-left">ZipCode</th>
          <th class="text-left">State</th>
          <th class="text-left">City</th>
          <th class="text-left">Street</th>
          <th class="text-left">AddressLine1</th>
          <th class="text-left">AddressLine2</th>     
          <th *ngIf="isEdit" width="1px"></th>
        </tr>
      </thead>
      <tbody class="border-bottom">
        <tr *ngFor="let office of model.Offices; let i = index" >
        
          <td>
            <mat-form-field>
                <input matInput placeholder="Office Code"  [(ngModel)]="office.OfficeCode" name="OfficeCode" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Office Name"  [(ngModel)]="office.OfficeName" name="OfficeName" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <!-- Date -->
          <td>
            <mat-form-field>
              <input matInput [matDatepicker]="RegistrationDatePicker" placeholder="Registration Date" [(ngModel)]="office.RegistrationDate" name="RegistrationDate" [disabled]="!isEdit">
              <mat-datepicker-toggle matSuffix [for]="RegistrationDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #RegistrationDatePicker></mat-datepicker>
            </mat-form-field> 
          </td> 
          <td>
            <mat-form-field>
                <input matInput placeholder="Currency Code"  [(ngModel)]="office.CurrencyCode" name="CurrencyCode" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="RegistrationNumber"  [(ngModel)]="office.RegistrationNumber" name="RegistrationNumber" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Phone"  [(ngModel)]="office.Phone" name="Phone" type="tel" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Email"  [(ngModel)]="office.Email" name="Email" type="email" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Url"  [(ngModel)]="office.Url" name="Url" type="url" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Country"  [(ngModel)]="office.Country" name="Country" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Zip Code"  [(ngModel)]="office.ZipCode" name="ZipCode" type="number" [disabled]="!isEdit"> 
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="State"  [(ngModel)]="office.State" name="State" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="City"  [(ngModel)]="office.City" name="City" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Street"  [(ngModel)]="office.Street" name="Street" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="Address Line1"  [(ngModel)]="office.AddressLine1" name="AddressLine1" [disabled]="!isEdit">
            </mat-form-field>
          </td>
          <td>
            <mat-form-field>
                <input matInput placeholder="AddressLine2"  [(ngModel)]="office.AddressLine2" name="AddressLine2" [disabled]="!isEdit">
            </mat-form-field>
          </td>     

          <td *ngIf="isEdit" style="width:1px">
            <fa-icon class="text-danger b-pointer" icon="trash-alt" (click)="onDeleteOffice(i, model)" title="Delete"></fa-icon>
          </td>
        </tr>
        <tr *ngIf="!isEdit && model.Offices?.length < 1">
          <td class="font-italic font-weight-light text-muted" colspan="1000">No items to display.</td>
        </tr>
        <tr *ngIf="isEdit">
          <td colspan="1000">&nbsp;<button class="btn btn-link text-primary p-0 border-0" type="button" (focus)="onAddOffice(model)">Add a office...</button></td>
        </tr>
        <tr *ngIf="model.Offices?.length < (isEdit ? 1 : 2)">
          <td colspan="1000">&nbsp;</td>
        </tr>
        <tr *ngIf="model.Offices?.length < (isEdit ? 2 : 3)">
          <td colspan="1000">&nbsp;</td>
        </tr>
      </tbody>
    </table>
  </div>
  
</ng-template>

<!-- Sidebar -->
<ng-template #sidebar let-model="model" let-isEdit="isEdit">
  <div class="d-flex justify-content-center">
    <div class="w-100 b-paper">
    <!--

      <div class="row m-0 pl-1 pl-sm-3 pr-1 pr-sm-3 pt-3 pt-sm-4 pb-3 pb-sm-5">
        <h6 class="col-12">Generated Credit Notes: </h6>
        <div class="m-1" style="float:left" *ngFor="let cn of model.GeneratedDocuments; let i = index">
          <button class="btn btn-primary" [disabled]="cn.State < 0" (click)="onDownloadCreditNote(cn)">
            <s *ngIf="cn.State < 0">{{ cn.SerialNumber | bSerial:'CN' }}</s>
            <span *ngIf="cn.State === 0"><fa-icon icon="download"></fa-icon>&nbsp;&nbsp;{{ cn.SerialNumber | bSerial:'CN' }} ({{ cn.Date | date }})</span>
          </button>
        </div>
        <div class="btn m-1" *ngIf="showSpinner">
          <span>
            <b-spinner></b-spinner>&nbsp;&nbsp;Downloading...
          </span>
        </div>
        <div class="btn m-1" *ngIf="!model.GeneratedDocuments || model.GeneratedDocuments.length === 0">
          <span>
            None
          </span>
        </div>
      </div>

      -->
    </div>
  </div>

</ng-template>  <!-- Edit/View Template -->

